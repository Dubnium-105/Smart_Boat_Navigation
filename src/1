#include <Arduino.h>

// 定义电机控制引脚
const int IN1 = 5;
const int IN2 = 4;
const int ENABLE_PIN = 3; // 假设有一个使能引脚，用于控制电机的电源

// 电机状态
enum MotorState {
    STOP,
    FORWARD,
    BACKWARD
};

MotorState currentState = STOP;

void setup() {
    // 设置电机控制引脚为输出模式
    pinMode(IN1, OUTPUT);
    pinMode(IN2, OUTPUT);
    pinMode(ENABLE_PIN, OUTPUT);

    // 初始化使能引脚为高电平，以启用电机电源
    digitalWrite(ENABLE_PIN, HIGH);

    // 初始化串口通信（可选，用于调试）
    Serial.begin(9600);
    Serial.println("Motor control initialized.");
}

void loop() {
    // 检查串口是否有可用数据
    if (Serial.available() > 0) {
        // 读取一个字符作为命令
        char cmd = Serial.read();

        // 根据命令改变电机状态
        switch (cmd) {
            case 's':
                currentState = STOP;
                break;
            case 'f':
                currentState = FORWARD;
                break;
            case 'b':
                currentState = BACKWARD;
                break;
            default:
                Serial.println("Unknown command");
                break;
        }

        // 根据当前状态控制电机
        switch (currentState) {
            case STOP:
                digitalWrite(IN1, LOW);
                digitalWrite(IN2, LOW);
                Serial.println("Motor Stopped.");
                break;
            case FORWARD:
                digitalWrite(IN1, HIGH);
                digitalWrite(IN2, LOW);
                Serial.println("Motor Forward.");
                break;
            case BACKWARD:
                digitalWrite(IN1, LOW);
                digitalWrite(IN2, HIGH);
                Serial.println("Motor Backward.");
                break;
        }
    }


}